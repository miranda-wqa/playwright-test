# ðŸ“Š Deploy All Playwright Reports to GitHub Pages
name: ðŸŒ Deploy All Reports to GitHub Pages

on:
  workflow_dispatch: # ðŸŸ¢ Manually triggered

jobs:
  deploy:
    name: ðŸ“‚ Deploy Archived Reports
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ§‘â€ðŸ’» Checkout repository
        uses: actions/checkout@v3

      - name: ðŸ•“ Generate timestamp
        id: time
        run: echo "timestamp=$(date +'%Y-%m-%d-%H%M%S')" >> $GITHUB_OUTPUT

      - name: ðŸ“¥ Download Playwright Report artifact
        uses: actions/download-artifact@v3
        with:
          name: playwright-report
          path: playwright-report

      - name: ðŸ“¦ Move report to timestamped folder
        run: |
          mkdir -p reports/run-${{ steps.time.outputs.timestamp }}
          mv playwright-report/* reports/run-${{ steps.time.outputs.timestamp }}

      - name: ðŸš€ Deploy to GitHub Pages (preserve previous)
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: reports                     # All reports go here
          publish_branch: gh-pages
          keep_files: true                         # âœ… Keep older reports
          force_orphan: false                      # âœ… Do not wipe history
          enable_jekyll: false